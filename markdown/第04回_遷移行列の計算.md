# 第4回：遷移行列の計算

## 学習目標
- 遷移行列の様々な計算方法を習得する
- ラプラス変換法、対角化法、Cayley-Hamilton法を理解する
- 実際の計算スキルを身につける

## 1. はじめに

前回、状態遷移行列 $\boldsymbol{\Phi}(t) = e^{\mathbf{A}t}$ の概念を学びました。本講では、この遷移行列を実際に計算する様々な方法を詳しく学びます。

## 2. ラプラス変換法

### 2.1 基本原理

状態遷移行列は、以下のラプラス逆変換で求められます：

$$\boldsymbol{\Phi}(t) = \mathcal{L}^{-1}\left[(s\mathbf{I} - \mathbf{A})^{-1}\right]$$

ここで、$(s\mathbf{I} - \mathbf{A})^{-1}$ は**レゾルベント行列**と呼ばれます。

### 2.2 計算手順

1. $(s\mathbf{I} - \mathbf{A})$ を計算
2. 逆行列 $(s\mathbf{I} - \mathbf{A})^{-1}$ を求める（余因子行列を利用）
3. 各要素をラプラス逆変換

### 2.3 例題

$$\mathbf{A} = \begin{bmatrix} 0 & 1 \\ -1 & -2 \end{bmatrix}$$

**ステップ1:**
$$s\mathbf{I} - \mathbf{A} = \begin{bmatrix} s & -1 \\ 1 & s+2 \end{bmatrix}$$

**ステップ2:**
$$\det(s\mathbf{I} - \mathbf{A}) = s(s+2) + 1 = s^2 + 2s + 1 = (s+1)^2$$

$$(\s\mathbf{I} - \mathbf{A})^{-1} = \frac{1}{(s+1)^2}\begin{bmatrix} s+2 & 1 \\ -1 & s \end{bmatrix}$$

**ステップ3:**
$$\boldsymbol{\Phi}(t) = \begin{bmatrix} (1+t)e^{-t} & te^{-t} \\ -te^{-t} & (1-t)e^{-t} \end{bmatrix}$$

## 3. 対角化法

### 3.1 基本原理

行列 $\mathbf{A}$ が対角化可能な場合：

$$\mathbf{A} = \mathbf{P}\boldsymbol{\Lambda}\mathbf{P}^{-1}$$

このとき：

$$e^{\mathbf{A}t} = \mathbf{P}e^{\boldsymbol{\Lambda}t}\mathbf{P}^{-1} = \mathbf{P}\text{diag}(e^{\lambda_1 t}, \ldots, e^{\lambda_n t})\mathbf{P}^{-1}$$

### 3.2 計算手順

1. 固有値 $\lambda_i$ を求める（特性方程式 $\det(\lambda\mathbf{I} - \mathbf{A}) = 0$ を解く）
2. 各固有値に対する固有ベクトル $\mathbf{v}_i$ を求める
3. $\mathbf{P} = [\mathbf{v}_1 \ \mathbf{v}_2 \ \cdots \ \mathbf{v}_n]$ を構成
4. $\mathbf{P}^{-1}$ を計算
5. $e^{\mathbf{A}t} = \mathbf{P}\text{diag}(e^{\lambda_1 t}, \ldots, e^{\lambda_n t})\mathbf{P}^{-1}$ を計算

### 3.3 例題

$$\mathbf{A} = \begin{bmatrix} 1 & 2 \\ 3 & 2 \end{bmatrix}$$

**固有値:**
$$\det(\lambda\mathbf{I} - \mathbf{A}) = (\lambda-1)(\lambda-2) - 6 = \lambda^2 - 3\lambda - 4 = 0$$
$$\lambda_1 = 4, \quad \lambda_2 = -1$$

**固有ベクトル:**
- $\lambda_1 = 4$: $\mathbf{v}_1 = \begin{bmatrix} 2 \\ 3 \end{bmatrix}$
- $\lambda_2 = -1$: $\mathbf{v}_2 = \begin{bmatrix} 1 \\ -1 \end{bmatrix}$

**遷移行列:**
$$e^{\mathbf{A}t} = \frac{1}{5}\begin{bmatrix} 2e^{4t} + 3e^{-t} & 2e^{4t} - 2e^{-t} \\ 3e^{4t} - 3e^{-t} & 3e^{4t} + 2e^{-t} \end{bmatrix}$$

## 4. Cayley-Hamiltonの定理を用いた方法

### 4.1 Cayley-Hamiltonの定理

任意の $n$ 次正方行列 $\mathbf{A}$ は、自身の特性方程式を満たす：

$$p(\mathbf{A}) = \mathbf{A}^n + a_{n-1}\mathbf{A}^{n-1} + \cdots + a_1\mathbf{A} + a_0\mathbf{I} = \mathbf{0}$$

### 4.2 応用

この定理により、$e^{\mathbf{A}t}$ を $n-1$ 次以下の多項式で表現できます：

$$e^{\mathbf{A}t} = \alpha_0(t)\mathbf{I} + \alpha_1(t)\mathbf{A} + \cdots + \alpha_{n-1}(t)\mathbf{A}^{n-1}$$

係数 $\alpha_i(t)$ は、固有値における条件から決定されます。

### 4.3 2次システムの例

特性方程式：$\lambda^2 + a_1\lambda + a_0 = 0$

固有値：$\lambda_1, \lambda_2$

このとき：
$$e^{\mathbf{A}t} = \alpha_0(t)\mathbf{I} + \alpha_1(t)\mathbf{A}$$

係数は以下の連立方程式から求めます：
$$e^{\lambda_1 t} = \alpha_0(t) + \alpha_1(t)\lambda_1$$
$$e^{\lambda_2 t} = \alpha_0(t) + \alpha_1(t)\lambda_2$$

## 5. べき級数法（直接計算）

### 5.1 定義による計算

$$e^{\mathbf{A}t} = \mathbf{I} + \mathbf{A}t + \frac{(\mathbf{A}t)^2}{2!} + \frac{(\mathbf{A}t)^3}{3!} + \cdots$$

この方法は、$\mathbf{A}$ が特殊な構造（べき零行列など）を持つ場合に有効です。

### 5.2 べき零行列の例

$$\mathbf{A} = \begin{bmatrix} 0 & 1 \\ 0 & 0 \end{bmatrix}$$

$\mathbf{A}^2 = \mathbf{0}$ より：

$$e^{\mathbf{A}t} = \mathbf{I} + \mathbf{A}t = \begin{bmatrix} 1 & t \\ 0 & 1 \end{bmatrix}$$

## 6. Jordan標準形を用いた方法

### 6.1 重複固有値の場合

行列が対角化できない場合（重複固有値を持つ場合）、Jordan標準形を用います：

$$\mathbf{A} = \mathbf{P}\mathbf{J}\mathbf{P}^{-1}$$

ここで、$\mathbf{J}$ はJordan標準形です。

### 6.2 Jordanブロックの指数関数

Jordan標準形:
$$\mathbf{J} = \begin{bmatrix} \mathbf{J}_1 & & \\ & \ddots & \\ & & \mathbf{J}_k \end{bmatrix}$$

各Jordanブロック：
$$\mathbf{J}_i = \begin{bmatrix} \lambda & 1 & & \\ & \lambda & \ddots & \\ & & \ddots & 1 \\ & & & \lambda \end{bmatrix}$$

に対して：
$$e^{\mathbf{J}_i t} = e^{\lambda t}\begin{bmatrix} 1 & t & \frac{t^2}{2!} & \cdots \\ & 1 & t & \cdots \\ & & \ddots & \ddots \\ & & & 1 \end{bmatrix}$$

## 7. 数値計算法

### 7.1 Padé近似

高精度な数値計算には、Padé近似が用いられます：

$$e^{\mathbf{A}t} \approx \left[\mathbf{I} - \frac{\mathbf{A}t}{2}\right]^{-1}\left[\mathbf{I} + \frac{\mathbf{A}t}{2}\right]$$

### 7.2 スケーリングと二乗法

大きな $t$ に対しては：
1. $\mathbf{A}t/2^m$ を計算（$m$ は十分大きな整数）
2. $e^{\mathbf{A}t/2^m}$ を近似計算
3. $m$ 回二乗して $e^{\mathbf{A}t}$ を得る

## 8. 演習問題

### 問題1
ラプラス変換法を用いて、以下の行列の状態遷移行列を求めよ：
$$\mathbf{A} = \begin{bmatrix} -2 & 1 \\ 0 & -3 \end{bmatrix}$$

### 問題2
対角化法を用いて、以下の行列の状態遷移行列を求めよ：
$$\mathbf{A} = \begin{bmatrix} 0 & 1 \\ -2 & -3 \end{bmatrix}$$

### 問題3
以下の行列に対して、Cayley-Hamiltonの定理を用いて $e^{\mathbf{A}t}$ を求めよ：
$$\mathbf{A} = \begin{bmatrix} 1 & 1 \\ 0 & 1 \end{bmatrix}$$

## 9. まとめ

- 遷移行列の計算には複数の方法がある
- ラプラス変換法：系統的で確実
- 対角化法：固有値が異なる場合に有効
- Cayley-Hamilton法：低次元システムに便利
- Jordan標準形：重複固有値の場合に必要
- 数値計算法：実用的な計算に重要

## 次回予告

次回は、**伝達関数と状態空間表現**の関係について学びます。古典制御と現代制御の橋渡しとなる重要な内容です。

## 参考文献

1. Chi-Tsong Chen, "Linear System Theory and Design"
2. 児玉慎三・須田信英『システム制御理論入門』コロナ社
3. Gilbert Strang, "Introduction to Linear Algebra"
