<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬1å›ï¼šã‚·ã‚¹ãƒ†ãƒ ã®çŠ¶æ…‹ç©ºé–“è¡¨ç¾</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.8;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        .content {
            padding: 40px;
        }
        h2 {
            color: #667eea;
            margin-top: 30px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        h3 {
            color: #764ba2;
            margin-top: 25px;
            margin-bottom: 10px;
        }
        .highlight-box {
            background: #f0f4ff;
            border-left: 5px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .example-box {
            background: #fff8e1;
            border-left: 5px solid #ffa726;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .interactive-demo {
            background: #e8f5e9;
            border: 2px solid #4caf50;
            padding: 25px;
            margin: 25px 0;
            border-radius: 10px;
        }
        .matrix-display {
            text-align: center;
            margin: 20px 0;
            font-size: 1.1em;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1em;
            border-radius: 25px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin: 10px 5px;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        .slider-container {
            margin: 15px 0;
        }
        input[type="range"] {
            width: 100%;
            margin: 10px 0;
        }
        canvas {
            border: 2px solid #ddd;
            border-radius: 5px;
            display: block;
            margin: 20px auto;
            background: white;
        }
        .formula {
            background: #f9f9f9;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            overflow-x: auto;
        }
        .exercise {
            background: #ffebee;
            border-left: 5px solid #e91e63;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .value-display {
            font-family: 'Courier New', monospace;
            background: #263238;
            color: #aed581;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        ul {
            margin-left: 30px;
            margin-top: 10px;
        }
        li {
            margin: 8px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“Š ç¬¬1å›ï¼šã‚·ã‚¹ãƒ†ãƒ ã®çŠ¶æ…‹ç©ºé–“è¡¨ç¾</h1>
            <p class="subtitle">State Space Representation of Systems</p>
        </header>
        
        <div class="content">
            <div class="highlight-box">
                <h3>ğŸ¯ å­¦ç¿’ç›®æ¨™</h3>
                <ul>
                    <li>å‹•çš„ã‚·ã‚¹ãƒ†ãƒ ã‚’çŠ¶æ…‹ç©ºé–“è¡¨ç¾ã§è¨˜è¿°ã™ã‚‹æ–¹æ³•ã‚’ç†è§£ã™ã‚‹</li>
                    <li>çŠ¶æ…‹å¤‰æ•°ã€å…¥åŠ›ã€å‡ºåŠ›ã®æ¦‚å¿µã‚’æŠŠæ¡ã™ã‚‹</li>
                    <li>çŠ¶æ…‹æ–¹ç¨‹å¼ã¨å‡ºåŠ›æ–¹ç¨‹å¼ã®æ§‹æˆæ–¹æ³•ã‚’å­¦ã¶</li>
                </ul>
            </div>

            <h2>1. ã¯ã˜ã‚ã«</h2>
            <p>åˆ¶å¾¡å·¥å­¦ã«ãŠã„ã¦ã€ã‚·ã‚¹ãƒ†ãƒ ã®å‹•çš„ãªæŒ¯ã‚‹èˆã„ã‚’æ•°å­¦çš„ã«è¡¨ç¾ã™ã‚‹ã“ã¨ã¯éå¸¸ã«é‡è¦ã§ã™ã€‚æœ¬è¬›ç¾©ã§ã¯ã€<strong>çŠ¶æ…‹ç©ºé–“è¡¨ç¾</strong>ã¨ã„ã†ç¾ä»£åˆ¶å¾¡ç†è«–ã®åŸºç¤ã¨ãªã‚‹è¡¨ç¾æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚</p>

            <h3>ãªãœçŠ¶æ…‹ç©ºé–“è¡¨ç¾ãŒå¿…è¦ã‹ï¼Ÿ</h3>
            <ul>
                <li>å¤šå…¥åŠ›å¤šå‡ºåŠ›ï¼ˆMIMOï¼‰ã‚·ã‚¹ãƒ†ãƒ ã®å–ã‚Šæ‰±ã„ãŒå®¹æ˜“</li>
                <li>å†…éƒ¨çŠ¶æ…‹ã®ç›´æ¥çš„ãªè¦³æ¸¬ã¨åˆ¶å¾¡ãŒå¯èƒ½</li>
                <li>éç·šå½¢ã‚·ã‚¹ãƒ†ãƒ ã¸ã®æ‹¡å¼µãŒè‡ªç„¶</li>
                <li>è¨ˆç®—æ©Ÿã«ã‚ˆã‚‹æ•°å€¤è¨ˆç®—ã«é©ã—ã¦ã„ã‚‹</li>
            </ul>

            <h2>2. çŠ¶æ…‹ç©ºé–“è¡¨ç¾ã®åŸºæœ¬æ¦‚å¿µ</h2>
            
            <div class="highlight-box">
                <h3>çŠ¶æ…‹å¤‰æ•°ã¨ã¯</h3>
                <p><strong>çŠ¶æ…‹å¤‰æ•°ï¼ˆstate variableï¼‰</strong>ã¨ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã®ç¾åœ¨ã®çŠ¶æ³ã‚’å®Œå…¨ã«è¨˜è¿°ã™ã‚‹ãŸã‚ã«å¿…è¦ãªæœ€å°é™ã®å¤‰æ•°ã®é›†åˆã§ã™ã€‚</p>
            </div>

            <div class="formula">
                <h3>çŠ¶æ…‹ç©ºé–“è¡¨ç¾ã®ä¸€èˆ¬å½¢</h3>
                <p><strong>çŠ¶æ…‹æ–¹ç¨‹å¼ï¼š</strong></p>
                <p>$$\dot{\mathbf{x}}(t) = \mathbf{A}\mathbf{x}(t) + \mathbf{B}\mathbf{u}(t)$$</p>
                <p><strong>å‡ºåŠ›æ–¹ç¨‹å¼ï¼š</strong></p>
                <p>$$\mathbf{y}(t) = \mathbf{C}\mathbf{x}(t) + \mathbf{D}\mathbf{u}(t)$$</p>
            </div>

            <h2>3. ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ‡ãƒ¢ï¼šè³ªé‡-ãƒãƒ-ãƒ€ãƒ³ãƒ‘ç³»</h2>
            
            <div class="interactive-demo">
                <h3>ğŸ”§ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´</h3>
                
                <div class="slider-container">
                    <label>è³ªé‡ m (kg): <span id="mass-value">2.0</span></label>
                    <input type="range" id="mass-slider" min="0.5" max="5" step="0.1" value="2">
                </div>
                
                <div class="slider-container">
                    <label>ãƒãƒå®šæ•° k (N/m): <span id="spring-value">8.0</span></label>
                    <input type="range" id="spring-slider" min="1" max="20" step="0.5" value="8">
                </div>
                
                <div class="slider-container">
                    <label>æ¸›è¡°ä¿‚æ•° c (NÂ·s/m): <span id="damping-value">4.0</span></label>
                    <input type="range" id="damping-slider" min="0" max="10" step="0.1" value="4">
                </div>

                <div class="slider-container">
                    <label>åˆæœŸå¤‰ä½ xâ‚€ (m): <span id="initial-value">1.0</span></label>
                    <input type="range" id="initial-slider" min="-2" max="2" step="0.1" value="1">
                </div>
                
                <button onclick="updateSimulation()">ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ</button>
                <button onclick="resetSimulation()">ãƒªã‚»ãƒƒãƒˆ</button>
                
                <div class="value-display">
                    <h4>ã‚·ã‚¹ãƒ†ãƒ è¡Œåˆ— A:</h4>
                    <pre id="matrix-a"></pre>
                    <h4>å…¥åŠ›è¡Œåˆ— B:</h4>
                    <pre id="matrix-b"></pre>
                </div>
                
                <canvas id="simulation-canvas" width="800" height="400"></canvas>
            </div>

            <div class="example-box">
                <h3>ğŸ“ ä¾‹ï¼šè³ªé‡-ãƒãƒ-ãƒ€ãƒ³ãƒ‘ç³»ã®çŠ¶æ…‹æ–¹ç¨‹å¼</h3>
                <p>é‹å‹•æ–¹ç¨‹å¼: \(m\ddot{x} + c\dot{x} + kx = f(t)\)</p>
                <p>çŠ¶æ…‹å¤‰æ•°: \(x_1 = x\), \(x_2 = \dot{x}\)</p>
                <div class="formula">
                    <p>$$\begin{bmatrix} \dot{x}_1 \\ \dot{x}_2 \end{bmatrix} = \begin{bmatrix} 0 & 1 \\ -\frac{k}{m} & -\frac{c}{m} \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} + \begin{bmatrix} 0 \\ \frac{1}{m} \end{bmatrix} f(t)$$</p>
                </div>
            </div>

            <h2>4. é«˜éšå¾®åˆ†æ–¹ç¨‹å¼ã‹ã‚‰ã®å¤‰æ›</h2>
            
            <div class="interactive-demo">
                <h3>ğŸ”„ å¯åˆ¶å¾¡æ­£æº–å½¢ã¸ã®å¤‰æ›ãƒ‡ãƒ¢</h3>
                <p>ä¸€èˆ¬çš„ãª2éšå¾®åˆ†æ–¹ç¨‹å¼: \(\ddot{y} + a_1\dot{y} + a_0 y = b_0 u(t)\)</p>
                
                <div class="slider-container">
                    <label>ä¿‚æ•° aâ‚: <span id="a1-value">3.0</span></label>
                    <input type="range" id="a1-slider" min="0" max="10" step="0.1" value="3">
                </div>
                
                <div class="slider-container">
                    <label>ä¿‚æ•° aâ‚€: <span id="a0-value">2.0</span></label>
                    <input type="range" id="a0-slider" min="0" max="10" step="0.1" value="2">
                </div>
                
                <div class="slider-container">
                    <label>ä¿‚æ•° bâ‚€: <span id="b0-value">1.0</span></label>
                    <input type="range" id="b0-slider" min="0" max="5" step="0.1" value="1">
                </div>
                
                <button onclick="updateCanonicalForm()">æ­£æº–å½¢ã‚’è¨ˆç®—</button>
                
                <div class="value-display">
                    <h4>å¯åˆ¶å¾¡æ­£æº–å½¢:</h4>
                    <pre id="canonical-result"></pre>
                </div>
            </div>

            <div class="exercise">
                <h3>ğŸ’¡ æ¼”ç¿’å•é¡Œ</h3>
                <h4>å•é¡Œ1</h4>
                <p>ä»¥ä¸‹ã®2éšå¾®åˆ†æ–¹ç¨‹å¼ã‚’çŠ¶æ…‹ç©ºé–“è¡¨ç¾ã«å¤‰æ›ã›ã‚ˆï¼š</p>
                <p>$$\ddot{y} + 3\dot{y} + 2y = u(t)$$</p>
                
                <h4>å•é¡Œ2</h4>
                <p>ä»¥ä¸‹ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒã¤è³ªé‡-ãƒãƒ-ãƒ€ãƒ³ãƒ‘ç³»ã®çŠ¶æ…‹ç©ºé–“è¡¨ç¾ã‚’æ±‚ã‚ã‚ˆï¼š</p>
                <ul>
                    <li>è³ªé‡ m = 2 kg</li>
                    <li>ãƒãƒå®šæ•° k = 8 N/m</li>
                    <li>æ¸›è¡°ä¿‚æ•° c = 4 NÂ·s/m</li>
                </ul>
            </div>

            <h2>5. ã¾ã¨ã‚</h2>
            <div class="highlight-box">
                <ul>
                    <li>çŠ¶æ…‹ç©ºé–“è¡¨ç¾ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã®å†…éƒ¨çŠ¶æ…‹ã‚’ç›´æ¥æ‰±ãˆã‚‹å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«</li>
                    <li>çŠ¶æ…‹æ–¹ç¨‹å¼ã¨å‡ºåŠ›æ–¹ç¨‹å¼ã®2ã¤ã®å¼ã§æ§‹æˆã•ã‚Œã‚‹</li>
                    <li>é«˜éšå¾®åˆ†æ–¹ç¨‹å¼ã‹ã‚‰ç³»çµ±çš„ã«å°å‡ºå¯èƒ½</li>
                    <li>ç·šå½¢æ€§ã¨æ™‚ä¸å¤‰æ€§ã¯åˆ¶å¾¡ç†è«–ã«ãŠã‘ã‚‹é‡è¦ãªæ€§è³ª</li>
                </ul>
            </div>

            <div style="text-align: center; margin-top: 40px; padding: 20px; background: #f5f5f5; border-radius: 10px;">
                <h3>ğŸ“š æ¬¡å›äºˆå‘Š</h3>
                <p>æ¬¡å›ã¯ã€<strong>PIDåˆ¶å¾¡</strong>ã«ã¤ã„ã¦å­¦ã³ã¾ã™ã€‚å¤å…¸çš„ãªãŒã‚‰ç”£æ¥­ç•Œã§æœ€ã‚‚åºƒãä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹åˆ¶å¾¡æ‰‹æ³•ã§ã™ã€‚</p>
            </div>
        </div>
    </div>

    <script>
        // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã®å€¤ã‚’è¡¨ç¤ºæ›´æ–°
        document.getElementById('mass-slider').addEventListener('input', function() {
            document.getElementById('mass-value').textContent = this.value;
            updateMatrices();
        });
        
        document.getElementById('spring-slider').addEventListener('input', function() {
            document.getElementById('spring-value').textContent = this.value;
            updateMatrices();
        });
        
        document.getElementById('damping-slider').addEventListener('input', function() {
            document.getElementById('damping-value').textContent = this.value;
            updateMatrices();
        });

        document.getElementById('initial-slider').addEventListener('input', function() {
            document.getElementById('initial-value').textContent = this.value;
        });

        document.getElementById('a1-slider').addEventListener('input', function() {
            document.getElementById('a1-value').textContent = this.value;
        });

        document.getElementById('a0-slider').addEventListener('input', function() {
            document.getElementById('a0-value').textContent = this.value;
        });

        document.getElementById('b0-slider').addEventListener('input', function() {
            document.getElementById('b0-value').textContent = this.value;
        });

        function updateMatrices() {
            const m = parseFloat(document.getElementById('mass-slider').value);
            const k = parseFloat(document.getElementById('spring-slider').value);
            const c = parseFloat(document.getElementById('damping-slider').value);
            
            const a11 = 0;
            const a12 = 1;
            const a21 = -k/m;
            const a22 = -c/m;
            
            document.getElementById('matrix-a').textContent = 
                `A = [\n  ${a11.toFixed(4)}  ${a12.toFixed(4)}\n  ${a21.toFixed(4)}  ${a22.toFixed(4)}\n]`;
            
            document.getElementById('matrix-b').textContent = 
                `B = [\n  0.0000\n  ${(1/m).toFixed(4)}\n]`;
        }

        function updateSimulation() {
            const canvas = document.getElementById('simulation-canvas');
            const ctx = canvas.getContext('2d');
            const m = parseFloat(document.getElementById('mass-slider').value);
            const k = parseFloat(document.getElementById('spring-slider').value);
            const c = parseFloat(document.getElementById('damping-slider').value);
            const x0 = parseFloat(document.getElementById('initial-slider').value);
            
            // ã‚¯ãƒªã‚¢
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // è»¸ã®æç”»
            ctx.strokeStyle = '#ccc';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(50, canvas.height/2);
            ctx.lineTo(canvas.width - 20, canvas.height/2);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(50, 20);
            ctx.lineTo(50, canvas.height - 20);
            ctx.stroke();
            
            // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
            const dt = 0.01;
            const tMax = 10;
            const steps = tMax / dt;
            
            let x1 = x0; // ä½ç½®
            let x2 = 0;  // é€Ÿåº¦
            
            const scaleX = (canvas.width - 70) / tMax;
            const scaleY = 80;
            const offsetY = canvas.height / 2;
            
            ctx.strokeStyle = '#667eea';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            for (let i = 0; i < steps; i++) {
                const t = i * dt;
                const x = 50 + t * scaleX;
                const y = offsetY - x1 * scaleY;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
                
                // ã‚ªã‚¤ãƒ©ãƒ¼æ³•ã§æ•°å€¤ç©åˆ†
                const dx1 = x2;
                const dx2 = -k/m * x1 - c/m * x2;
                
                x1 += dx1 * dt;
                x2 += dx2 * dt;
            }
            
            ctx.stroke();
            
            // ãƒ©ãƒ™ãƒ«
            ctx.fillStyle = '#333';
            ctx.font = '14px Arial';
            ctx.fillText('æ™‚é–“ (s)', canvas.width - 60, canvas.height/2 + 20);
            ctx.fillText('å¤‰ä½ (m)', 10, 30);
            ctx.fillText('0', 45, canvas.height/2 + 20);
            ctx.fillText(tMax, canvas.width - 30, canvas.height/2 + 20);
        }

        function resetSimulation() {
            document.getElementById('mass-slider').value = 2;
            document.getElementById('spring-slider').value = 8;
            document.getElementById('damping-slider').value = 4;
            document.getElementById('initial-slider').value = 1;
            
            document.getElementById('mass-value').textContent = '2.0';
            document.getElementById('spring-value').textContent = '8.0';
            document.getElementById('damping-value').textContent = '4.0';
            document.getElementById('initial-value').textContent = '1.0';
            
            updateMatrices();
            updateSimulation();
        }

        function updateCanonicalForm() {
            const a1 = parseFloat(document.getElementById('a1-slider').value);
            const a0 = parseFloat(document.getElementById('a0-slider').value);
            const b0 = parseFloat(document.getElementById('b0-slider').value);
            
            const result = `A = [\n  0.0000   1.0000\n  ${(-a0).toFixed(4)}  ${(-a1).toFixed(4)}\n]\n\nB = [\n  0.0000\n  ${b0.toFixed(4)}\n]\n\nC = [\n  1.0000   0.0000\n]\n\nD = [0.0000]`;
            
            document.getElementById('canonical-result').textContent = result;
        }

        // åˆæœŸåŒ–
        updateMatrices();
        updateSimulation();
        updateCanonicalForm();
    </script>
</body>
</html>