# 第9回：可観測性

## 学習目標
- 可観測性の概念と可制御性との双対関係を理解する
- 可観測性行列を用いた判定方法を習得する
- オブザーバ設計の基礎を学ぶ

## 1. はじめに

前回、可制御性を学びました。本講では、その双対概念である**可観測性（observability）**を学びます。可観測性は、出力から内部状態を推定できるかを表す重要な概念です。

## 2. 可観測性の定義

### 2.1 完全可観測性

線形システム：
$$\dot{\mathbf{x}}(t) = \mathbf{A}\mathbf{x}(t) + \mathbf{B}\mathbf{u}(t)$$
$$\mathbf{y}(t) = \mathbf{C}\mathbf{x}(t) + \mathbf{D}\mathbf{u}(t)$$

において、有限時間 $[t_0, T]$ における出力 $\mathbf{y}(t)$ と入力 $\mathbf{u}(t)$ の観測から、初期状態 $\mathbf{x}(t_0)$ を一意に決定できるとき、このシステムは**完全可観測**（completely observable）であるといいます。

### 2.2 物理的意味

可観測性とは：
- すべての状態変数が出力に影響を与えること
- 出力測定から内部状態を推定（再構成）できること
- オブザーバ（状態推定器）の設計が可能であること

## 3. 可観測性の判定

### 3.1 可観測性行列

$n$ 次元システム $(\mathbf{A}, \mathbf{C})$ に対して、**可観測性行列** $\mathbf{O}$ を以下のように定義します：

$$\mathbf{O} = \begin{bmatrix} \mathbf{C} \\ \mathbf{C}\mathbf{A} \\ \mathbf{C}\mathbf{A}^2 \\ \vdots \\ \mathbf{C}\mathbf{A}^{n-1} \end{bmatrix}$$

**可観測性判別定理（Kalmanのランク条件）：**

システムが完全可観測である必要十分条件は：
$$\text{rank}(\mathbf{O}) = n$$

### 3.2 双対性原理

可観測性と可制御性には双対関係があります：

システム $(\mathbf{A}, \mathbf{B}, \mathbf{C})$ が可観測 ⇔ 双対システム $(\mathbf{A}^T, \mathbf{C}^T, \mathbf{B}^T)$ が可制御

この双対性により、可制御性の理論をそのまま可観測性に適用できます。

### 3.3 例題

**例1：可観測なシステム**

$$\mathbf{A} = \begin{bmatrix} 0 & 1 \\ -2 & -3 \end{bmatrix}, \quad \mathbf{C} = \begin{bmatrix} 1 & 0 \end{bmatrix}$$

可観測性行列：
$$\mathbf{O} = \begin{bmatrix} \mathbf{C} \\ \mathbf{C}\mathbf{A} \end{bmatrix} = \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}$$

$$\det(\mathbf{O}) = 1 \neq 0 \Rightarrow \text{rank}(\mathbf{O}) = 2$$

したがって、**完全可観測**です。

**例2：可観測でないシステム**

$$\mathbf{A} = \begin{bmatrix} 1 & 0 \\ 0 & 2 \end{bmatrix}, \quad \mathbf{C} = \begin{bmatrix} 1 & 0 \end{bmatrix}$$

可観測性行列：
$$\mathbf{O} = \begin{bmatrix} 1 & 0 \\ 1 & 0 \end{bmatrix}$$

$$\text{rank}(\mathbf{O}) = 1 < 2$$

したがって、**可観測ではありません**。第2の状態変数 $x_2$ は観測できません。

## 4. 可観測部分空間

### 4.1 不可観測部分空間

可観測でないシステムにおいて、観測不可能な状態の集合を**不可観測部分空間**と呼びます。

### 4.2 可観測・不可観測分解

適当な座標変換により、システムを可観測部分と不可観測部分に分解できます：

$$\begin{bmatrix} \dot{\bar{\mathbf{x}}}_o \\ \dot{\bar{\mathbf{x}}}_{\bar{o}} \end{bmatrix} = \begin{bmatrix} \bar{\mathbf{A}}_{11} & \mathbf{0} \\ \bar{\mathbf{A}}_{21} & \bar{\mathbf{A}}_{22} \end{bmatrix}\begin{bmatrix} \bar{\mathbf{x}}_o \\ \bar{\mathbf{x}}_{\bar{o}} \end{bmatrix} + \begin{bmatrix} \bar{\mathbf{B}}_1 \\ \bar{\mathbf{B}}_2 \end{bmatrix}\mathbf{u}$$

$$\mathbf{y} = \begin{bmatrix} \bar{\mathbf{C}}_1 & \mathbf{0} \end{bmatrix}\begin{bmatrix} \bar{\mathbf{x}}_o \\ \bar{\mathbf{x}}_{\bar{o}} \end{bmatrix}$$

ここで、$(\bar{\mathbf{A}}_{11}, \bar{\mathbf{C}}_1)$ は可観測です。

## 5. 可観測正準形

### 5.1 定義

システムが完全可観測ならば、以下の**可観測正準形**（observable canonical form）に変換できます：

$$\bar{\mathbf{A}} = \begin{bmatrix} 0 & 0 & \cdots & 0 & -a_0 \\ 1 & 0 & \cdots & 0 & -a_1 \\ 0 & 1 & \cdots & 0 & -a_2 \\ \vdots & \vdots & \ddots & \vdots & \vdots \\ 0 & 0 & \cdots & 1 & -a_{n-1} \end{bmatrix}, \quad \bar{\mathbf{C}} = \begin{bmatrix} 0 & 0 & \cdots & 0 & 1 \end{bmatrix}$$

### 5.2 変換方法

変換は双対性を利用して、可制御正準形の変換を適用します。

## 6. 伝達関数との関係

### 6.1 可観測性と極零相殺

システムが可観測でない場合、伝達関数において極と零点の相殺が生じます。

**例：**
$$\mathbf{A} = \begin{bmatrix} -1 & 0 \\ 0 & -2 \end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix} 1 \\ 1 \end{bmatrix}, \quad \mathbf{C} = \begin{bmatrix} 0 & 1 \end{bmatrix}$$

伝達関数：
$$G(s) = \mathbf{C}(s\mathbf{I} - \mathbf{A})^{-1}\mathbf{B} = \frac{1}{s+2}$$

固有値 $\lambda_1 = -1$ が伝達関数に現れません（不可観測モード）。

### 6.2 最小実現との関係

伝達関数の最小実現は、可制御かつ可観測なシステムです。

## 7. 可観測性グラミアン

### 7.1 定義

連続時間システムの**可観測性グラミアン**：

$$\mathbf{W}_o = \int_0^\infty e^{\mathbf{A}^Tt}\mathbf{C}^T\mathbf{C}e^{\mathbf{A}t}dt$$

システムが安定かつ可観測ならば、$\mathbf{W}_o > 0$ です。

### 7.2 リアプノフ方程式

可観測性グラミアンは以下のリアプノフ方程式の解です：

$$\mathbf{A}^T\mathbf{W}_o + \mathbf{W}_o\mathbf{A} = -\mathbf{C}^T\mathbf{C}$$

これは双対性により、可制御性グラミアンのリアプノフ方程式の双対です。

## 8. オブザーバの基礎

### 8.1 状態推定の必要性

実際のシステムでは、すべての状態変数を直接測定できないことが多いです。そこで、出力測定から状態を推定する**オブザーバ（observer）**が必要になります。

### 8.2 オブザーバの構造

最も基本的なオブザーバは、以下の形式です：

$$\dot{\hat{\mathbf{x}}} = \mathbf{A}\hat{\mathbf{x}} + \mathbf{B}\mathbf{u} + \mathbf{L}(\mathbf{y} - \mathbf{C}\hat{\mathbf{x}})$$

ここで：
- $\hat{\mathbf{x}}$：推定状態
- $\mathbf{L}$：オブザーバゲイン
- $\mathbf{y} - \mathbf{C}\hat{\mathbf{x}}$：推定誤差（イノベーション）

### 8.3 推定誤差のダイナミクス

推定誤差 $\mathbf{e} = \mathbf{x} - \hat{\mathbf{x}}$ のダイナミクスは：

$$\dot{\mathbf{e}} = (\mathbf{A} - \mathbf{L}\mathbf{C})\mathbf{e}$$

システムが可観測ならば、適当な $\mathbf{L}$ を選んで $\mathbf{A} - \mathbf{L}\mathbf{C}$ を安定にできます。

## 9. 平衡実現

### 9.1 定義

可制御性グラミアンと可観測性グラミアンが等しく対角になる実現を**平衡実現**（balanced realization）と呼びます：

$$\mathbf{W}_c = \mathbf{W}_o = \boldsymbol{\Sigma} = \text{diag}(\sigma_1, \sigma_2, \ldots, \sigma_n)$$

ここで、$\sigma_i$ は**Hankel特異値**と呼ばれます。

### 9.2 モデル低次元化

Hankel特異値が小さいモードは、可制御性と可観測性の両方が弱いため、削除してもシステムの入出力特性にあまり影響しません。

これにより、システムの次数を削減できます（モデル低次元化）。

## 10. 離散時間システムの可観測性

### 10.1 可観測性行列

離散時間システム：
$$\mathbf{x}[k+1] = \mathbf{A}_d\mathbf{x}[k] + \mathbf{B}_d\mathbf{u}[k]$$
$$\mathbf{y}[k] = \mathbf{C}_d\mathbf{x}[k]$$

可観測性行列：
$$\mathbf{O}_d = \begin{bmatrix} \mathbf{C}_d \\ \mathbf{C}_d\mathbf{A}_d \\ \vdots \\ \mathbf{C}_d\mathbf{A}_d^{n-1} \end{bmatrix}$$

可観測性判定：$\text{rank}(\mathbf{O}_d) = n$

## 11. 演習問題

### 問題1
以下のシステムの可観測性を判定せよ：
$$\mathbf{A} = \begin{bmatrix} 1 & 2 \\ 3 & 4 \end{bmatrix}, \quad \mathbf{C} = \begin{bmatrix} 1 & 1 \end{bmatrix}$$

### 問題2
以下のシステムの不可観測モードを求めよ：
$$\mathbf{A} = \begin{bmatrix} -1 & 0 & 0 \\ 0 & -2 & 1 \\ 0 & 0 & -3 \end{bmatrix}, \quad \mathbf{C} = \begin{bmatrix} 1 & 0 & 0 \end{bmatrix}$$

### 問題3
システム $(\mathbf{A}, \mathbf{C})$ が可観測であることと、双対システム $(\mathbf{A}^T, \mathbf{C}^T)$ が可制御であることが等価であることを、ランク条件を用いて示せ。

## 12. まとめ

- 可観測性は、出力から内部状態を推定できるかを表す
- 可観測性行列のランクにより判定可能
- 可制御性と可観測性には双対関係がある
- 完全可観測なシステムは可観測正準形に変換可能
- オブザーバ設計には可観測性が必要
- 平衡実現はモデル低次元化に有用

## 次回予告

次回は、**状態フィードバックと極配置**について学びます。可制御性を利用した制御系設計の基本手法です。

## 参考文献

1. Chi-Tsong Chen, "Linear System Theory and Design"
2. 児玉慎三・須田信英『システム制御理論入門』コロナ社
3. Thomas Kailath, "Linear Systems"
