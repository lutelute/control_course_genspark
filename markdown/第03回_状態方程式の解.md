# 第3回：状態方程式の解

## 学習目標
- 線形時不変システムの状態方程式の解法を理解する
- 状態遷移行列の概念と意味を把握する
- 初期値応答と強制応答の関係を学ぶ

## 1. はじめに

前回までに、システムを状態空間表現で記述する方法を学びました。本講では、線形時不変（LTI）システムの状態方程式：

$$\dot{\mathbf{x}}(t) = \mathbf{A}\mathbf{x}(t) + \mathbf{B}\mathbf{u}(t)$$

の解を求める方法を学びます。この解は、システムの時間応答を解析的に表現する強力なツールです。

## 2. 斉次方程式の解（入力がない場合）

### 2.1 スカラー方程式の場合

まず、最も単純な1次元の場合を考えます：

$$\dot{x}(t) = ax(t), \quad x(0) = x_0$$

この微分方程式の解は：

$$x(t) = e^{at}x_0$$

### 2.2 ベクトル方程式への拡張

$n$ 次元のシステム：

$$\dot{\mathbf{x}}(t) = \mathbf{A}\mathbf{x}(t), \quad \mathbf{x}(0) = \mathbf{x}_0$$

の解は、行列指数関数を用いて：

$$\mathbf{x}(t) = e^{\mathbf{A}t}\mathbf{x}_0$$

ここで、$e^{\mathbf{A}t}$ は**行列指数関数**（matrix exponential）と呼ばれます。

## 3. 行列指数関数

### 3.1 定義

行列指数関数は、以下のべき級数で定義されます：

$$e^{\mathbf{A}t} = \mathbf{I} + \mathbf{A}t + \frac{(\mathbf{A}t)^2}{2!} + \frac{(\mathbf{A}t)^3}{3!} + \cdots = \sum_{k=0}^{\infty} \frac{(\mathbf{A}t)^k}{k!}$$

### 3.2 性質

行列指数関数は以下の重要な性質を持ちます：

1. **初期条件**: $e^{\mathbf{A} \cdot 0} = \mathbf{I}$（単位行列）
2. **微分**: $\frac{d}{dt}e^{\mathbf{A}t} = \mathbf{A}e^{\mathbf{A}t} = e^{\mathbf{A}t}\mathbf{A}$
3. **加法性**: $e^{\mathbf{A}(t_1+t_2)} = e^{\mathbf{A}t_1}e^{\mathbf{A}t_2}$（$\mathbf{A}$が可換な場合）
4. **逆行列**: $(e^{\mathbf{A}t})^{-1} = e^{-\mathbf{A}t}$

### 3.3 計算方法

#### 方法1：対角化を利用

行列 $\mathbf{A}$ が対角化可能な場合：

$$\mathbf{A} = \mathbf{P}\boldsymbol{\Lambda}\mathbf{P}^{-1}$$

ここで、$\boldsymbol{\Lambda} = \text{diag}(\lambda_1, \lambda_2, \ldots, \lambda_n)$ は固有値の対角行列です。

このとき：

$$e^{\mathbf{A}t} = \mathbf{P}e^{\boldsymbol{\Lambda}t}\mathbf{P}^{-1} = \mathbf{P}\begin{bmatrix} e^{\lambda_1 t} & & \\ & \ddots & \\ & & e^{\lambda_n t} \end{bmatrix}\mathbf{P}^{-1}$$

#### 方法2：Cayley-Hamiltonの定理を利用

$n$ 次正方行列 $\mathbf{A}$ の特性多項式：

$$p(\lambda) = \det(\lambda\mathbf{I} - \mathbf{A}) = \lambda^n + a_{n-1}\lambda^{n-1} + \cdots + a_1\lambda + a_0$$

により、$e^{\mathbf{A}t}$ を $n-1$ 次以下の多項式で表現できます。

#### 方法3：ラプラス変換を利用

$$e^{\mathbf{A}t} = \mathcal{L}^{-1}\left[(s\mathbf{I} - \mathbf{A})^{-1}\right]$$

## 4. 状態遷移行列

### 4.1 定義

**状態遷移行列** $\boldsymbol{\Phi}(t)$ は：

$$\boldsymbol{\Phi}(t) = e^{\mathbf{A}t}$$

これは、初期状態 $\mathbf{x}(0)$ を時刻 $t$ での状態 $\mathbf{x}(t)$ に遷移させる行列です：

$$\mathbf{x}(t) = \boldsymbol{\Phi}(t)\mathbf{x}(0)$$

### 4.2 一般的な状態遷移行列

時刻 $t_0$ から時刻 $t$ への遷移を考える場合：

$$\boldsymbol{\Phi}(t, t_0) = e^{\mathbf{A}(t-t_0)}$$

これにより：

$$\mathbf{x}(t) = \boldsymbol{\Phi}(t, t_0)\mathbf{x}(t_0)$$

### 4.3 性質

1. $\boldsymbol{\Phi}(0) = \mathbf{I}$
2. $\boldsymbol{\Phi}(t_2, t_0) = \boldsymbol{\Phi}(t_2, t_1)\boldsymbol{\Phi}(t_1, t_0)$（半群性）
3. $\boldsymbol{\Phi}^{-1}(t, t_0) = \boldsymbol{\Phi}(t_0, t)$
4. $\frac{d}{dt}\boldsymbol{\Phi}(t, t_0) = \mathbf{A}\boldsymbol{\Phi}(t, t_0)$

## 5. 非斉次方程式の解（入力がある場合）

入力 $\mathbf{u}(t)$ がある場合の状態方程式：

$$\dot{\mathbf{x}}(t) = \mathbf{A}\mathbf{x}(t) + \mathbf{B}\mathbf{u}(t), \quad \mathbf{x}(t_0) = \mathbf{x}_0$$

の解は、**初期値応答**と**強制応答**の和として表されます：

$$\mathbf{x}(t) = \underbrace{e^{\mathbf{A}(t-t_0)}\mathbf{x}_0}_{\text{初期値応答}} + \underbrace{\int_{t_0}^{t} e^{\mathbf{A}(t-\tau)}\mathbf{B}\mathbf{u}(\tau)d\tau}_{\text{強制応答}}$$

### 5.1 解の導出

定数変化法（variation of constants）を用いて導出します。

1. 斉次解を $\mathbf{x}_h(t) = e^{\mathbf{A}t}\mathbf{c}$ とする
2. 非斉次解を $\mathbf{x}(t) = e^{\mathbf{A}t}\mathbf{c}(t)$ と仮定（$\mathbf{c}$ を時間の関数とする）
3. 微分して元の方程式に代入
4. $\mathbf{c}(t)$ を求める

結果として上記の解が得られます。

### 5.2 出力の計算

出力方程式：

$$\mathbf{y}(t) = \mathbf{C}\mathbf{x}(t) + \mathbf{D}\mathbf{u}(t)$$

に状態の解を代入すると：

$$\mathbf{y}(t) = \mathbf{C}e^{\mathbf{A}(t-t_0)}\mathbf{x}_0 + \int_{t_0}^{t} \mathbf{C}e^{\mathbf{A}(t-\tau)}\mathbf{B}\mathbf{u}(\tau)d\tau + \mathbf{D}\mathbf{u}(t)$$

## 6. 具体例

### 例1：2次システム

以下のシステムを考えます：

$$\mathbf{A} = \begin{bmatrix} 0 & 1 \\ -2 & -3 \end{bmatrix}$$

**固有値の計算：**
$$\det(\lambda\mathbf{I} - \mathbf{A}) = \lambda^2 + 3\lambda + 2 = (\lambda + 1)(\lambda + 2) = 0$$

固有値：$\lambda_1 = -1, \lambda_2 = -2$

**固有ベクトルの計算：**
- $\lambda_1 = -1$ に対して：$\mathbf{v}_1 = \begin{bmatrix} 1 \\ -1 \end{bmatrix}$
- $\lambda_2 = -2$ に対して：$\mathbf{v}_2 = \begin{bmatrix} 1 \\ -2 \end{bmatrix}$

**状態遷移行列：**
$$\mathbf{P} = \begin{bmatrix} 1 & 1 \\ -1 & -2 \end{bmatrix}, \quad \mathbf{P}^{-1} = \begin{bmatrix} 2 & 1 \\ -1 & -1 \end{bmatrix}$$

$$e^{\mathbf{A}t} = \begin{bmatrix} 1 & 1 \\ -1 & -2 \end{bmatrix} \begin{bmatrix} e^{-t} & 0 \\ 0 & e^{-2t} \end{bmatrix} \begin{bmatrix} 2 & 1 \\ -1 & -1 \end{bmatrix}$$

$$= \begin{bmatrix} 2e^{-t} - e^{-2t} & e^{-t} - e^{-2t} \\ -2e^{-t} + 2e^{-2t} & -e^{-t} + 2e^{-2t} \end{bmatrix}$$

### 例2：ステップ入力に対する応答

システム：
$$\dot{\mathbf{x}} = \begin{bmatrix} 0 & 1 \\ 0 & -1 \end{bmatrix}\mathbf{x} + \begin{bmatrix} 0 \\ 1 \end{bmatrix}u, \quad u(t) = 1 \text{ (ステップ)}$$

初期条件：$\mathbf{x}(0) = \begin{bmatrix} 0 \\ 0 \end{bmatrix}$

**解：**
$$\mathbf{x}(t) = \int_0^t e^{\mathbf{A}(t-\tau)}\mathbf{B}d\tau$$

具体的な計算により：
$$\mathbf{x}(t) = \begin{bmatrix} 1 - e^{-t} \\ 1 - e^{-t} \end{bmatrix}$$

## 7. 安定性との関係

システムの安定性は、状態遷移行列 $e^{\mathbf{A}t}$ の挙動によって決まります：

- **漸近安定**: すべての固有値の実部が負 → $\lim_{t \to \infty} e^{\mathbf{A}t} = \mathbf{0}$
- **不安定**: いずれかの固有値の実部が正 → $\lim_{t \to \infty} \|e^{\mathbf{A}t}\| = \infty$
- **限界安定**: すべての固有値の実部が非正で、実部がゼロの固有値は単純

## 8. 演習問題

### 問題1
以下のシステム行列の状態遷移行列 $e^{\mathbf{A}t}$ を求めよ：
$$\mathbf{A} = \begin{bmatrix} -1 & 0 \\ 0 & -2 \end{bmatrix}$$

### 問題2
以下のシステムについて、初期条件 $\mathbf{x}(0) = \begin{bmatrix} 1 \\ 0 \end{bmatrix}$ からの状態応答を求めよ：
$$\dot{\mathbf{x}} = \begin{bmatrix} 0 & 1 \\ -1 & -2 \end{bmatrix}\mathbf{x}$$

### 問題3
行列指数関数の性質 $\frac{d}{dt}e^{\mathbf{A}t} = \mathbf{A}e^{\mathbf{A}t}$ を、べき級数の定義から証明せよ。

## 9. まとめ

- 線形時不変システムの状態方程式の解は、行列指数関数を用いて表現される
- 状態遷移行列 $\boldsymbol{\Phi}(t) = e^{\mathbf{A}t}$ は初期状態を現在状態に変換する
- 一般解は初期値応答と強制応答の和として表される
- 固有値と固有ベクトルを用いて状態遷移行列を計算できる
- システムの安定性は $\mathbf{A}$ の固有値によって決まる

## 次回予告

次回は、**遷移行列の計算**について、より詳細な計算方法と実用的なテクニックを学びます。

## 参考文献

1. Chi-Tsong Chen, "Linear System Theory and Design"
2. 吉川恒夫・井村順一『現代制御論』昭晃堂
3. 足立修一『システム制御理論入門』コロナ社
