<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>第1回：システムの状態空間表現</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']]
        }
      };
    </script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            border-bottom: 1px solid #bdc3c7;
            padding-bottom: 5px;
            margin-top: 30px;
        }
        h3 {
            color: #2c3e50;
            margin-top: 25px;
        }
        h4 {
            color: #34495e;
            margin-top: 20px;
        }
        .nav-link {
            position: fixed;
            top: 20px;
            left: 20px;
            background: #3498db;
            color: white;
            padding: 10px 15px;
            text-decoration: none;
            border-radius: 5px;
            z-index: 1000;
        }
        .nav-link:hover {
            background: #2980b9;
        }
        .motivation-box {
            background: #e8f6f3;
            padding: 20px;
            border-left: 4px solid #16a085;
            margin: 20px 0;
            border-radius: 5px;
        }
        .important-note {
            background: #fef5e7;
            padding: 15px;
            border-left: 4px solid #f39c12;
            margin: 20px 0;
            border-radius: 5px;
        }
        .step-box {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 3px solid #3498db;
        }
        .theory-box {
            background: #e8f4f8;
            padding: 20px;
            border-left: 4px solid #3498db;
            margin: 20px 0;
            border-radius: 5px;
        }
        .example-box {
            background: #f0f8ff;
            padding: 20px;
            border: 2px solid #4169e1;
            margin: 20px 0;
            border-radius: 8px;
        }
        ul {
            padding-left: 20px;
        }
        li {
            margin: 8px 0;
        }
        .highlight {
            background: #fff3cd;
            padding: 2px 4px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <a href="../index.html" class="nav-link">← ダッシュボードに戻る</a>
    <div class="container">

<h1>第1回：システムの状態空間表現</h1>

<h2>学習目標</h2>
<ul>
<li>動的システムを状態空間表現で記述する方法を理解する</li>
<li>状態変数、入力、出力の概念を把握する</li>
<li>状態方程式と出力方程式の構成方法を学ぶ</li>
</ul>

<h2>1. はじめに</h2>

<p>制御工学において、システムの動的な振る舞いを数学的に表現することは非常に重要です。本講義では、<strong>状態空間表現</strong>という現代制御理論の基礎となる表現方法を学びます。</p>

<h3>なぜ状態空間表現が必要か？</h3>

<p>従来の伝達関数による表現と比較して、状態空間表現には以下の利点があります：</p>
<ul>
<li>多入力多出力（MIMO）システムの取り扱いが容易</li>
<li>内部状態の直接的な観測と制御が可能</li>
<li>非線形システムへの拡張が自然</li>
<li>計算機による数値計算に適している</li>
</ul>

<h2>2. 状態空間表現の基本概念</h2>

<h3>2.1 状態変数とは</h3>

<p><strong>状態変数（state variable）</strong>とは、システムの現在の状況を完全に記述するために必要な最小限の変数の集合です。</p>

<div class="example-box">
<p><strong>例：質点の運動</strong></p>
<ul>
<li>位置 $x(t)$</li>
<li>速度 $v(t) = \dot{x}(t)$</li>
</ul>
<p>これら2つの変数があれば、将来の運動を予測できます。</p>
</div>

<h3>2.2 状態空間表現への道筋</h3>

<p>システムの動的挙動を記述するには、時間に関する微分方程式が必要です。しかし、高階の微分方程式は扱いにくいため、<strong>1階の微分方程式の連立</strong>に変換します。</p>

<h4>なぜ1階の連立微分方程式なのか？</h4>

<div class="motivation-box">
<p><strong>理由1: 数値計算の容易性</strong></p>
<ul>
<li>コンピュータは1階微分の数値計算が得意</li>
<li>高階微分は数値誤差が蓄積しやすい</li>
</ul>

<p><strong>理由2: 物理的直感</strong></p>
<ul>
<li>各状態変数が物理的意味を持つ</li>
<li>システムの「内部状態」が見える</li>
</ul>

<p><strong>理由3: 統一的表現</strong></p>
<ul>
<li>多入力多出力システムも同じ形式で表現</li>
<li>線形代数の強力なツールが使える</li>
</ul>
</div>

<h4>状態空間表現の構築ステップ</h4>

<div class="step-box">
<p><strong>Step 1: 状態変数の選択</strong></p>

<p>システムを完全に記述するために必要な独立な変数を選びます。一般的な選択基準：</p>
<ul>
<li>エネルギー貯蔵要素に関連する量</li>
<li>システムの「記憶」を表す量</li>
</ul>
</div>

<div class="step-box">
<p><strong>Step 2: 1階微分方程式の導出</strong></p>

<p>各状態変数の時間微分を、他の状態変数と入力の関数として表現します。</p>
</div>

<div class="step-box">
<p><strong>Step 3: 行列形式への整理</strong></p>

<p>連立微分方程式を行列・ベクトルの形式にまとめます。</p>
</div>

<h3>2.3 状態空間表現の一般形</h3>

<p>以上の手順を経て得られる線形時不変（LTI: Linear Time-Invariant）システムの状態空間表現は以下の標準形式で表されます：</p>

<div class="theory-box">
<p><strong>状態方程式：</strong></p>
<p>$$\dot{\mathbf{x}}(t) = \mathbf{A}\mathbf{x}(t) + \mathbf{B}\mathbf{u}(t)$$</p>

<p><strong>出力方程式：</strong></p>
<p>$$\mathbf{y}(t) = \mathbf{C}\mathbf{x}(t) + \mathbf{D}\mathbf{u}(t)$$</p>
</div>

<h4>各要素の物理的意味</h4>

<div class="important-note">
<p><strong>ベクトル：</strong></p>
<ul>
<li><span class="highlight">$\mathbf{x}(t) \in \mathbb{R}^n$</span>：<strong>状態ベクトル</strong>（n次元）
  <ul>
    <li>システムの現在の状況を完全に記述</li>
    <li>例：位置、速度、電荷、電流など</li>
  </ul>
</li>
  
<li><span class="highlight">$\mathbf{u}(t) \in \mathbb{R}^m$</span>：<strong>入力ベクトル</strong>（m次元）
  <ul>
    <li>外部から加える制御信号や外乱</li>
    <li>例：力、電圧、熱流など</li>
  </ul>
</li>
  
<li><span class="highlight">$\mathbf{y}(t) \in \mathbb{R}^p$</span>：<strong>出力ベクトル</strong>（p次元）
  <ul>
    <li>観測・測定可能な量</li>
    <li>例：変位、温度、角度など</li>
  </ul>
</li>
</ul>
</div>

<div class="important-note">
<p><strong>行列とその意味：</strong></p>
<ul>
<li><span class="highlight">$\mathbf{A} \in \mathbb{R}^{n \times n}$</span>：<strong>システム行列（動態行列）</strong>
  <ul>
    <li>システム固有のダイナミクスを表現</li>
    <li>「入力がない場合のシステムの自然な発展」を記述</li>
    <li>安定性、振動特性などを決定する最重要行列</li>
  </ul>
</li>
  
<li><span class="highlight">$\mathbf{B} \in \mathbb{R}^{n \times m}$</span>：<strong>入力行列（制御行列）</strong>
  <ul>
    <li>入力が状態にどのように影響するかを記述</li>
    <li>「どの入力がどの状態に作用するか」を表現</li>
  </ul>
</li>
  
<li><span class="highlight">$\mathbf{C} \in \mathbb{R}^{p \times n}$</span>：<strong>出力行列（観測行列）</strong>
  <ul>
    <li>状態から出力への関係を表現</li>
    <li>「どの状態が観測可能か」を決定</li>
  </ul>
</li>
  
<li><span class="highlight">$\mathbf{D} \in \mathbb{R}^{p \times m}$</span>：<strong>直達項行列（フィードスルー行列）</strong>
  <ul>
    <li>入力から出力への直接的な影響</li>
    <li>物理システムでは多くの場合ゼロ行列</li>
  </ul>
</li>
</ul>
</div>

<h2>3. 具体例で理解するシステム行列</h2>

<h3>例1：質量-バネ-ダンパ系</h3>

<p>質量 $m$、バネ定数 $k$、減衰係数 $c$ の1自由度系を考え、状態空間表現の各行列がどのように決まるかを詳しく見てみましょう。</p>

<h4>物理系の設定</h4>

<div class="example-box">
<p>[質量-バネ-ダンパ系の図]</p> 
<ul>
<li>質量 $m$ の物体がバネ（バネ定数 $k$）とダンパ（減衰係数 $c$）に接続</li>
<li>外力 $f(t)$ が作用</li>
<li>変位 $x(t)$ を測定</li>
</ul>
</div>

<h4>Step 1: 運動方程式の導出</h4>

<p>ニュートンの第2法則より：</p>
<p>$$m\ddot{x} + c\dot{x} + kx = f(t)$$</p>

<p>この2階微分方程式を1階の連立微分方程式に変換します。</p>

<h4>Step 2: 状態変数の選択</h4>

<p>エネルギー観点から物理的に意味のある量を選択：</p>
<ul>
<li>$x_1 = x$（位置：ポテンシャルエネルギーに関連）</li>
<li>$x_2 = \dot{x}$（速度：運動エネルギーに関連）</li>
</ul>

<h4>Step 3: 1階微分方程式の導出</h4>

<div class="step-box">
<p><strong>第1式：</strong> $\dot{x}_1$ の導出</p>
<p>$$\dot{x}_1 = \frac{d}{dt}x = \dot{x} = x_2$$</p>
</div>

<div class="step-box">
<p><strong>第2式：</strong> $\dot{x}_2$ の導出</p>

<p>元の運動方程式を $\ddot{x}$ について解く：</p>
<p>$$\ddot{x} = -\frac{c}{m}\dot{x} - \frac{k}{m}x + \frac{1}{m}f(t)$$</p>

<p>状態変数で表現：</p>
<p>$$\dot{x}_2 = \frac{d}{dt}\dot{x} = \ddot{x} = -\frac{k}{m}x_1 - \frac{c}{m}x_2 + \frac{1}{m}f(t)$$</p>
</div>

<h4>Step 4: 行列形式への整理</h4>

<p>連立微分方程式：</p>
<p>$$\begin{cases}
\dot{x}_1 = 0 \cdot x_1 + 1 \cdot x_2 + 0 \cdot f(t) \\
\dot{x}_2 = -\frac{k}{m} x_1 - \frac{c}{m} x_2 + \frac{1}{m} f(t)
\end{cases}$$</p>

<div class="theory-box">
<p><strong>行列形式：</strong></p>
<p>$$\begin{bmatrix} \dot{x}_1 \\ \dot{x}_2 \end{bmatrix} = \begin{bmatrix} 0 & 1 \\ -\frac{k}{m} & -\frac{c}{m} \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} + \begin{bmatrix} 0 \\ \frac{1}{m} \end{bmatrix} f(t)$$</p>
</div>

<h4>各行列の物理的解釈</h4>

<div class="important-note">
<p><strong>システム行列 $\mathbf{A}$：</strong></p>
<p>$$\mathbf{A} = \begin{bmatrix} 0 & 1 \\ -\frac{k}{m} & -\frac{c}{m} \end{bmatrix}$$</p>

<ul>
<li><strong>$(1,1)$要素 = 0</strong>：位置は位置に直接影響しない</li>
<li><strong>$(1,2)$要素 = 1</strong>：速度が位置の変化率そのもの</li>
<li><strong>$(2,1)$要素 = $-\frac{k}{m}$</strong>：バネ力による加速度（復元力）</li>
<li><strong>$(2,2)$要素 = $-\frac{c}{m}$</strong>：減衰力による加速度（速度に比例する抵抗）</li>
</ul>
</div>

<div class="important-note">
<p><strong>入力行列 $\mathbf{B}$：</strong></p>
<p>$$\mathbf{B} = \begin{bmatrix} 0 \\ \frac{1}{m} \end{bmatrix}$$</p>

<ul>
<li><strong>第1要素 = 0</strong>：外力は位置に直接作用しない</li>
<li><strong>第2要素 = $\frac{1}{m}$</strong>：外力は質量で割った値で速度の変化率（加速度）に作用</li>
</ul>
</div>

<h4>Step 5: 出力方程式</h4>

<div class="step-box">
<p><strong>変位を出力とする場合：</strong></p>
<p>$$y = x = x_1 = \begin{bmatrix} 1 & 0 \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \end{bmatrix}$$</p>

<p><strong>出力行列 $\mathbf{C}$：</strong></p>
<p>$$\mathbf{C} = \begin{bmatrix} 1 & 0 \end{bmatrix}$$</p>

<ul>
<li>第1状態変数（位置）のみを観測</li>
<li>第2状態変数（速度）は直接観測しない</li>
</ul>
</div>

<div class="theory-box">
<p><strong>完全な状態空間表現：</strong></p>
<p>$$\begin{cases}
\dot{\mathbf{x}} = \begin{bmatrix} 0 & 1 \\ -\frac{k}{m} & -\frac{c}{m} \end{bmatrix} \mathbf{x} + \begin{bmatrix} 0 \\ \frac{1}{m} \end{bmatrix} f \\
y = \begin{bmatrix} 1 & 0 \end{bmatrix} \mathbf{x}
\end{cases}$$</p>

<p><strong>この例から、各行列の要素は物理法則と状態変数の定義から自然に決まることが分かります。</strong></p>
</div>

<h2>4. 具体例：電気回路</h2>

<h3>例2：RLC回路</h3>

<p>抵抗 $R$、インダクタンス $L$、キャパシタンス $C$ からなる直列RLC回路を考えます。</p>

<p>キルヒホッフの法則より：</p>
<p>$$L\frac{di}{dt} + Ri + \frac{1}{C}\int i \, dt = v_{in}(t)$$</p>

<div class="step-box">
<p><strong>状態変数の選択：</strong></p>
<p>$$x_1 = \int i \, dt = q \quad (\text{電荷})$$</p>
<p>$$x_2 = i = \dot{q} \quad (\text{電流})$$</p>

<p><strong>状態方程式：</strong></p>
<p>$$\dot{x}_1 = x_2$$</p>
<p>$$\dot{x}_2 = -\frac{1}{LC}x_1 - \frac{R}{L}x_2 + \frac{1}{L}v_{in}$$</p>

<p><strong>行列形式：</strong></p>
<p>$$\begin{bmatrix} \dot{x}_1 \\ \dot{x}_2 \end{bmatrix} = \begin{bmatrix} 0 & 1 \\ -\frac{1}{LC} & -\frac{R}{L} \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} + \begin{bmatrix} 0 \\ \frac{1}{L} \end{bmatrix} v_{in}$$</p>
</div>

<h2>5. まとめ</h2>

<div class="important-note">
<p><strong>状態空間表現の要点：</strong></p>
<ul>
<li>高階微分方程式を1階の連立微分方程式に変換</li>
<li>物理的に意味のある状態変数を選択</li>
<li>システム行列の各要素は物理法則から決まる</li>
<li>現代制御理論の基礎となる重要な表現方法</li>
</ul>
</div>

<h2>次回予告</h2>

<p>次回は、<strong>PID制御</strong>について学びます。制御工学の基礎となる古典的な制御手法です。</p>

    </div>
</body>
</html>