# 第1回：システムの状態空間表現

## 学習目標
- 動的システムを状態空間表現で記述する方法を理解する
- 状態変数、入力、出力の概念を把握する
- 状態方程式と出力方程式の構成方法を学ぶ

## 1. はじめに

制御工学において、システムの動的な振る舞いを数学的に表現することは非常に重要です。本講義では、**状態空間表現**という現代制御理論の基礎となる表現方法を学びます。

### なぜ状態空間表現が必要か？

従来の伝達関数による表現と比較して、状態空間表現には以下の利点があります：
- 多入力多出力（MIMO）システムの取り扱いが容易
- 内部状態の直接的な観測と制御が可能
- 非線形システムへの拡張が自然
- 計算機による数値計算に適している

## 2. 状態空間表現の基本概念

### 2.1 状態変数とは

**状態変数（state variable）**とは、システムの現在の状況を完全に記述するために必要な最小限の変数の集合です。

例：質点の運動
- 位置 $x(t)$
- 速度 $v(t) = \dot{x}(t)$

これら2つの変数があれば、将来の運動を予測できます。

### 2.2 状態空間表現の一般形

線形時不変（LTI: Linear Time-Invariant）システムの状態空間表現は以下の形式で表されます：

**状態方程式：**
$$\dot{\mathbf{x}}(t) = \mathbf{A}\mathbf{x}(t) + \mathbf{B}\mathbf{u}(t)$$

**出力方程式：**
$$\mathbf{y}(t) = \mathbf{C}\mathbf{x}(t) + \mathbf{D}\mathbf{u}(t)$$

ここで：
- $\mathbf{x}(t) \in \mathbb{R}^n$：状態ベクトル（n次元）
- $\mathbf{u}(t) \in \mathbb{R}^m$：入力ベクトル（m次元）
- $\mathbf{y}(t) \in \mathbb{R}^p$：出力ベクトル（p次元）
- $\mathbf{A} \in \mathbb{R}^{n \times n}$：システム行列
- $\mathbf{B} \in \mathbb{R}^{n \times m}$：入力行列
- $\mathbf{C} \in \mathbb{R}^{p \times n}$：出力行列
- $\mathbf{D} \in \mathbb{R}^{p \times m}$：直達項行列（多くの場合ゼロ）

## 3. 具体例：機械システム

### 例1：質量-バネ-ダンパ系

質量 $m$、バネ定数 $k$、減衰係数 $c$ の1自由度系を考えます。

運動方程式：
$$m\ddot{x} + c\dot{x} + kx = f(t)$$

ここで、$f(t)$ は外力、$x(t)$ は変位です。

**状態変数の選択：**
$$x_1 = x, \quad x_2 = \dot{x}$$

**状態方程式の導出：**
$$\dot{x}_1 = x_2$$
$$\dot{x}_2 = \frac{1}{m}f(t) - \frac{k}{m}x_1 - \frac{c}{m}x_2$$

**行列形式：**
$$\begin{bmatrix} \dot{x}_1 \\ \dot{x}_2 \end{bmatrix} = \begin{bmatrix} 0 & 1 \\ -\frac{k}{m} & -\frac{c}{m} \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} + \begin{bmatrix} 0 \\ \frac{1}{m} \end{bmatrix} f(t)$$

変位を出力とする場合：
$$y = \begin{bmatrix} 1 & 0 \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \end{bmatrix}$$

## 4. 具体例：電気回路

### 例2：RLC回路

抵抗 $R$、インダクタンス $L$、キャパシタンス $C$ からなる直列RLC回路を考えます。

キルヒホッフの法則より：
$$L\frac{di}{dt} + Ri + \frac{1}{C}\int i \, dt = v_{in}(t)$$

**状態変数の選択：**
$$x_1 = \int i \, dt = q \quad (\text{電荷})$$
$$x_2 = i = \dot{q} \quad (\text{電流})$$

**状態方程式：**
$$\dot{x}_1 = x_2$$
$$\dot{x}_2 = -\frac{1}{LC}x_1 - \frac{R}{L}x_2 + \frac{1}{L}v_{in}$$

**行列形式：**
$$\begin{bmatrix} \dot{x}_1 \\ \dot{x}_2 \end{bmatrix} = \begin{bmatrix} 0 & 1 \\ -\frac{1}{LC} & -\frac{R}{L} \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} + \begin{bmatrix} 0 \\ \frac{1}{L} \end{bmatrix} v_{in}$$

## 5. 高階微分方程式からの変換

一般的な $n$ 階線形微分方程式：
$$\frac{d^n y}{dt^n} + a_{n-1}\frac{d^{n-1}y}{dt^{n-1}} + \cdots + a_1\frac{dy}{dt} + a_0 y = b_0 u(t)$$

**可制御正準形（Controllable Canonical Form）への変換：**

状態変数を以下のように定義：
$$x_1 = y, \quad x_2 = \dot{y}, \quad \ldots, \quad x_n = y^{(n-1)}$$

すると、状態方程式は：
$$\begin{bmatrix} \dot{x}_1 \\ \dot{x}_2 \\ \vdots \\ \dot{x}_{n-1} \\ \dot{x}_n \end{bmatrix} = \begin{bmatrix} 0 & 1 & 0 & \cdots & 0 \\ 0 & 0 & 1 & \cdots & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & 0 & \cdots & 1 \\ -a_0 & -a_1 & -a_2 & \cdots & -a_{n-1} \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \\ \vdots \\ x_{n-1} \\ x_n \end{bmatrix} + \begin{bmatrix} 0 \\ 0 \\ \vdots \\ 0 \\ b_0 \end{bmatrix} u$$

$$y = \begin{bmatrix} 1 & 0 & \cdots & 0 \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \\ \vdots \\ x_n \end{bmatrix}$$

## 6. 線形性と時不変性

### 6.1 線形性

システムが**線形**であるとは、以下の性質を満たすことです：

1. **重ね合わせの原理**：
   - 入力 $u_1$ に対する出力が $y_1$
   - 入力 $u_2$ に対する出力が $y_2$
   - ならば、入力 $u_1 + u_2$ に対する出力は $y_1 + y_2$

2. **斉次性（スケーリング）**：
   - 入力 $u$ に対する出力が $y$
   - ならば、入力 $\alpha u$ に対する出力は $\alpha y$

### 6.2 時不変性

システムが**時不変**であるとは、システムのパラメータが時間によって変化しないことです。つまり、行列 $\mathbf{A}, \mathbf{B}, \mathbf{C}, \mathbf{D}$ が定数行列であることを意味します。

## 7. 演習問題

### 問題1
以下の2階微分方程式を状態空間表現に変換せよ：
$$\ddot{y} + 3\dot{y} + 2y = u(t)$$

### 問題2
以下のパラメータを持つ質量-バネ-ダンパ系の状態空間表現を求めよ：
- 質量 $m = 2$ kg
- バネ定数 $k = 8$ N/m
- 減衰係数 $c = 4$ N·s/m

### 問題3
RC回路（抵抗 $R$ とキャパシタ $C$ の直列接続）の状態空間表現を導出せよ。入力を電圧源 $v_{in}(t)$、出力をキャパシタ電圧 $v_C(t)$ とする。

## 8. まとめ

- 状態空間表現は、システムの内部状態を直接扱える強力なツール
- 状態方程式と出力方程式の2つの式で構成される
- 高階微分方程式から系統的に導出可能
- 線形性と時不変性は制御理論における重要な性質

## 次回予告

次回は、**PID制御**について学びます。古典的ながら産業界で最も広く使用されている制御手法です。

## 参考文献

1. 吉川恒夫・井村順一『現代制御論』昭晃堂
2. 足立修一『システム制御理論入門』コロナ社
3. Katsuhiko Ogata, "Modern Control Engineering", Prentice Hall
