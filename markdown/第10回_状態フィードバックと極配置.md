# 第10回：状態フィードバックと極配置

## 学習目標
- 状態フィードバック制御の原理を理解する
- 極配置法による制御器設計を習得する
- Ackermannの公式を学ぶ

## 1. はじめに

可制御性の概念を学んだことで、システムの極（固有値）を任意の位置に配置できることがわかりました。本講では、**状態フィードバック**による制御系設計と**極配置法**を学びます。

## 2. 状態フィードバック制御

### 2.1 基本構造

システム：
$$\dot{\mathbf{x}} = \mathbf{A}\mathbf{x} + \mathbf{B}\mathbf{u}$$

に対して、以下の**状態フィードバック制御**を適用します：

$$\mathbf{u} = -\mathbf{K}\mathbf{x} + \mathbf{r}$$

ここで：
- $\mathbf{K}$：状態フィードバックゲイン行列
- $\mathbf{r}$：目標値（参照入力）

### 2.2 閉ループシステム

状態フィードバックを適用した閉ループシステムは：

$$\dot{\mathbf{x}} = (\mathbf{A} - \mathbf{B}\mathbf{K})\mathbf{x} + \mathbf{B}\mathbf{r}$$

閉ループシステムの極（固有値）は、$\mathbf{A} - \mathbf{B}\mathbf{K}$ の固有値で決まります。

### 2.3 レギュレータ問題

$\mathbf{r} = \mathbf{0}$ の場合、すなわち：

$$\mathbf{u} = -\mathbf{K}\mathbf{x}$$

は**レギュレータ問題**と呼ばれ、状態を原点に安定化することが目的です。

## 3. 極配置定理

### 3.1 定理の内容

**極配置定理（Pole Placement Theorem）：**

システム $(\mathbf{A}, \mathbf{B})$ が可制御ならば、任意の極の集合 $\{\lambda_1, \lambda_2, \ldots, \lambda_n\}$ に対して、閉ループシステム $\mathbf{A} - \mathbf{B}\mathbf{K}$ の固有値が $\{\lambda_1, \lambda_2, \ldots, \lambda_n\}$ となるようなフィードバックゲイン $\mathbf{K}$ が存在する。

**注意事項：**
- 複素固有値は共役ペアでなければならない（実係数システムの場合）
- ゲイン $\mathbf{K}$ は一意ではない（SISO の場合は一意）

### 3.2 証明の概略

可制御性により、システムを可制御正準形に変換できます。可制御正準形では、最下行のパラメータを変更することで、特性多項式の係数を直接指定でき、したがって極を任意に配置できます。

## 4. 極配置の設計手順（直接法）

### 4.1 手順

**ステップ1：** 希望する極 $\{\lambda_1, \lambda_2, \ldots, \lambda_n\}$ を決定

**ステップ2：** 希望する特性多項式を構成：
$$\alpha_c(s) = (s - \lambda_1)(s - \lambda_2)\cdots(s - \lambda_n) = s^n + \alpha_{n-1}s^{n-1} + \cdots + \alpha_1s + \alpha_0$$

**ステップ3：** 開ループシステムの特性多項式：
$$\det(s\mathbf{I} - \mathbf{A}) = s^n + a_{n-1}s^{n-1} + \cdots + a_1s + a_0$$

**ステップ4：** フィードバックゲイン $\mathbf{K}$ を求める（具体的方法は以下）

### 4.2 可制御正準形を用いた方法

システムが可制御正準形の場合：

$$\mathbf{A} = \begin{bmatrix} 0 & 1 & \cdots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \cdots & 1 \\ -a_0 & -a_1 & \cdots & -a_{n-1} \end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix} 0 \\ \vdots \\ 0 \\ 1 \end{bmatrix}$$

フィードバックゲインは：

$$\mathbf{K} = \begin{bmatrix} \alpha_0 - a_0 & \alpha_1 - a_1 & \cdots & \alpha_{n-1} - a_{n-1} \end{bmatrix}$$

### 4.3 一般形の場合

一般形のシステムは、可制御正準形に変換してから上記の方法を適用し、元の座標系に戻します。

## 5. Ackermannの公式

### 5.1 公式

任意の可制御システム $(\mathbf{A}, \mathbf{B})$ に対して、フィードバックゲイン $\mathbf{K}$ は以下のように求められます：

$$\mathbf{K} = \begin{bmatrix} 0 & 0 & \cdots & 0 & 1 \end{bmatrix} \mathbf{C}_c^{-1} \alpha_c(\mathbf{A})$$

ここで：
- $\mathbf{C}_c = \begin{bmatrix} \mathbf{B} & \mathbf{A}\mathbf{B} & \cdots & \mathbf{A}^{n-1}\mathbf{B} \end{bmatrix}$：可制御性行列
- $\alpha_c(\mathbf{A}) = \mathbf{A}^n + \alpha_{n-1}\mathbf{A}^{n-1} + \cdots + \alpha_1\mathbf{A} + \alpha_0\mathbf{I}$：希望する特性多項式を $\mathbf{A}$ に代入

### 5.2 例題

$$\mathbf{A} = \begin{bmatrix} 0 & 1 \\ -2 & -3 \end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix} 0 \\ 1 \end{bmatrix}$$

希望する極：$\lambda_1 = -2 + j2$, $\lambda_2 = -2 - j2$

**ステップ1：** 希望する特性多項式：
$$\alpha_c(s) = (s + 2 - j2)(s + 2 + j2) = s^2 + 4s + 8$$

**ステップ2：** 可制御性行列：
$$\mathbf{C}_c = \begin{bmatrix} 0 & 1 \\ 1 & -3 \end{bmatrix}, \quad \mathbf{C}_c^{-1} = \begin{bmatrix} 3 & 1 \\ 1 & 0 \end{bmatrix}$$

**ステップ3：** $\alpha_c(\mathbf{A})$ を計算：
$$\alpha_c(\mathbf{A}) = \mathbf{A}^2 + 4\mathbf{A} + 8\mathbf{I}$$

$$\mathbf{A}^2 = \begin{bmatrix} -2 & -3 \\ 6 & 7 \end{bmatrix}$$

$$\alpha_c(\mathbf{A}) = \begin{bmatrix} -2 & -3 \\ 6 & 7 \end{bmatrix} + 4\begin{bmatrix} 0 & 1 \\ -2 & -3 \end{bmatrix} + 8\begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix} = \begin{bmatrix} 6 & 1 \\ -2 & 3 \end{bmatrix}$$

**ステップ4：** Ackermannの公式を適用：
$$\mathbf{K} = \begin{bmatrix} 0 & 1 \end{bmatrix} \begin{bmatrix} 3 & 1 \\ 1 & 0 \end{bmatrix} \begin{bmatrix} 6 & 1 \\ -2 & 3 \end{bmatrix} = \begin{bmatrix} 6 & 7 \end{bmatrix}$$

## 6. 極の選択

### 6.1 設計指針

極の位置は、以下の要求性能に基づいて選択します：

1. **安定性**：すべての極を左半平面に配置
2. **応答速度**：極を左側に配置するほど速い応答
3. **オーバーシュート**：減衰係数 $\zeta$ を適切に選ぶ
4. **制御入力の大きさ**：極を左に配置しすぎると大きな制御入力が必要

### 6.2 2次系の標準的な極配置

減衰係数 $\zeta$ と固有角周波数 $\omega_n$ を指定：

$$\lambda_{1,2} = -\zeta\omega_n \pm j\omega_n\sqrt{1 - \zeta^2}$$

**典型的な値：**
- $\zeta = 0.7$：オーバーシュート約5%、良好な応答
- $\omega_n$：希望する応答速度に応じて設定

### 6.3 高次系の極配置

高次系では、以下のような配置が一般的です：

- **支配的な極**：応答特性を決定する2次系の極（複素共役ペア）
- **その他の極**：支配的な極の実部の3～5倍左側に配置

## 7. 実装上の問題

### 7.1 センサノイズ

状態フィードバックには、すべての状態の測定が必要です。しかし、測定にはノイズが含まれます。

**対策：**
- 極を過度に左側に配置しない（高周波ノイズの増幅を避ける）
- オブザーバを使用（次回講義）

### 7.2 アクチュエータ飽和

極を左側に配置しすぎると、過大な制御入力が必要になり、アクチュエータが飽和します。

**対策：**
- 現実的な極配置
- アンチワインドアップ機構の実装

## 8. MIMO システムの極配置

### 8.1 多入力システム

$m$ 入力システムの場合、フィードバックゲイン $\mathbf{K}$ は $m \times n$ 行列です。

可制御ならば、極配置可能ですが、$\mathbf{K}$ は一意ではありません。

### 8.2 追加の自由度

MIMO システムでは、極配置に加えて、以下の性能も最適化できます：
- 固有ベクトルの配置
- 制御入力の配分
- ロバスト性の向上

## 9. 演習問題

### 問題1
以下のシステムに対して、極を $\lambda_1 = -3$, $\lambda_2 = -4$ に配置するフィードバックゲイン $\mathbf{K}$ を求めよ：
$$\mathbf{A} = \begin{bmatrix} 0 & 1 \\ -1 & -2 \end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix} 0 \\ 1 \end{bmatrix}$$

### 問題2
Ackermannの公式を用いて、以下のシステムの極を $\lambda_{1,2} = -2 \pm j$ に配置せよ：
$$\mathbf{A} = \begin{bmatrix} 1 & 1 \\ 0 & -1 \end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix} 0 \\ 1 \end{bmatrix}$$

### 問題3
なぜ極を左半平面の極めて左側（例えば $\lambda = -1000$）に配置するのが実用的でないか、説明せよ。

## 10. まとめ

- 状態フィードバックにより、閉ループシステムの極を任意に配置できる
- 極配置が可能であるための必要十分条件は可制御性
- Ackermannの公式により、フィードバックゲインを系統的に計算可能
- 極の選択は、応答速度、オーバーシュート、制御入力の大きさのトレードオフ
- 実装では、センサノイズやアクチュエータ飽和に注意が必要

## 次回予告

次回は、**オブザーバ**について詳しく学びます。状態が直接測定できない場合の状態推定器の設計方法です。

## 参考文献

1. Katsuhiko Ogata, "Modern Control Engineering"
2. 児玉慎三・須田信英『システム制御理論入門』コロナ社
3. Gene F. Franklin et al., "Feedback Control of Dynamic Systems"
