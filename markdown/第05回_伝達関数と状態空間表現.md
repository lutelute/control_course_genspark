# 第5回：伝達関数と状態空間表現

## 学習目標
- 伝達関数と状態空間表現の相互変換を理解する
- 実現問題の概念を把握する
- 正準形による表現方法を学ぶ

## 1. はじめに

古典制御理論では伝達関数を、現代制御理論では状態空間表現を用います。これら2つの表現は本質的に同じシステムを異なる視点から記述したものです。本講では、両者の関係と相互変換について学びます。

## 2. 伝達関数から状態空間表現への変換

### 2.1 伝達関数の定義

単入力単出力（SISO）システムの伝達関数：

$$G(s) = \frac{Y(s)}{U(s)} = \frac{b_ms^m + b_{m-1}s^{m-1} + \cdots + b_1s + b_0}{s^n + a_{n-1}s^{n-1} + \cdots + a_1s + a_0}$$

ここで、通常 $m \leq n$ です（プロパーシステム）。

### 2.2 可制御正準形（Controllable Canonical Form）

伝達関数：
$$G(s) = \frac{b_0}{s^n + a_{n-1}s^{n-1} + \cdots + a_1s + a_0}$$

に対する状態空間表現：

$$\mathbf{A} = \begin{bmatrix} 0 & 1 & 0 & \cdots & 0 \\ 0 & 0 & 1 & \cdots & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & 0 & \cdots & 1 \\ -a_0 & -a_1 & -a_2 & \cdots & -a_{n-1} \end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix} 0 \\ 0 \\ \vdots \\ 0 \\ 1 \end{bmatrix}$$

$$\mathbf{C} = \begin{bmatrix} b_0 & 0 & \cdots & 0 \end{bmatrix}, \quad \mathbf{D} = [0]$$

**特徴：**
- 最下行に特性多項式の係数が現れる
- 制御入力が直接最後の状態変数に作用
- 可制御性が保証される

### 2.3 可観測正準形（Observable Canonical Form）

同じ伝達関数に対して：

$$\mathbf{A} = \begin{bmatrix} 0 & 0 & \cdots & 0 & -a_0 \\ 1 & 0 & \cdots & 0 & -a_1 \\ 0 & 1 & \cdots & 0 & -a_2 \\ \vdots & \vdots & \ddots & \vdots & \vdots \\ 0 & 0 & \cdots & 1 & -a_{n-1} \end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix} b_0 \\ 0 \\ \vdots \\ 0 \end{bmatrix}$$

$$\mathbf{C} = \begin{bmatrix} 0 & 0 & \cdots & 0 & 1 \end{bmatrix}, \quad \mathbf{D} = [0]$$

**特徴：**
- 最右列に特性多項式の係数が現れる
- 出力が最後の状態変数から直接得られる
- 可観測性が保証される

### 2.4 対角正準形（Diagonal Canonical Form）

伝達関数が部分分数展開可能な場合：

$$G(s) = \frac{c_1}{s-\lambda_1} + \frac{c_2}{s-\lambda_2} + \cdots + \frac{c_n}{s-\lambda_n}$$

状態空間表現：

$$\mathbf{A} = \begin{bmatrix} \lambda_1 & & & \\ & \lambda_2 & & \\ & & \ddots & \\ & & & \lambda_n \end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix} 1 \\ 1 \\ \vdots \\ 1 \end{bmatrix}$$

$$\mathbf{C} = \begin{bmatrix} c_1 & c_2 & \cdots & c_n \end{bmatrix}, \quad \mathbf{D} = [0]$$

**特徴：**
- システム行列が対角
- 各状態変数が独立したモードを表現
- 固有値が明示的

## 3. 状態空間表現から伝達関数への変換

### 3.1 基本公式

状態空間表現 $(\mathbf{A}, \mathbf{B}, \mathbf{C}, \mathbf{D})$ から伝達関数への変換：

$$G(s) = \mathbf{C}(s\mathbf{I} - \mathbf{A})^{-1}\mathbf{B} + \mathbf{D}$$

### 3.2 導出

状態方程式と出力方程式をラプラス変換：

$$s\mathbf{X}(s) - \mathbf{x}(0) = \mathbf{A}\mathbf{X}(s) + \mathbf{B}U(s)$$
$$\mathbf{Y}(s) = \mathbf{C}\mathbf{X}(s) + \mathbf{D}U(s)$$

初期条件ゼロ（$\mathbf{x}(0) = \mathbf{0}$）として：

$$\mathbf{X}(s) = (s\mathbf{I} - \mathbf{A})^{-1}\mathbf{B}U(s)$$
$$\mathbf{Y}(s) = [\mathbf{C}(s\mathbf{I} - \mathbf{A})^{-1}\mathbf{B} + \mathbf{D}]U(s)$$

よって：
$$G(s) = \frac{\mathbf{Y}(s)}{U(s)} = \mathbf{C}(s\mathbf{I} - \mathbf{A})^{-1}\mathbf{B} + \mathbf{D}$$

### 3.3 計算例

$$\mathbf{A} = \begin{bmatrix} 0 & 1 \\ -2 & -3 \end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix} 0 \\ 1 \end{bmatrix}$$
$$\mathbf{C} = \begin{bmatrix} 1 & 0 \end{bmatrix}, \quad \mathbf{D} = [0]$$

**計算：**
$$s\mathbf{I} - \mathbf{A} = \begin{bmatrix} s & -1 \\ 2 & s+3 \end{bmatrix}$$

$$\det(s\mathbf{I} - \mathbf{A}) = s(s+3) + 2 = s^2 + 3s + 2$$

$$(s\mathbf{I} - \mathbf{A})^{-1} = \frac{1}{s^2+3s+2}\begin{bmatrix} s+3 & 1 \\ -2 & s \end{bmatrix}$$

$$G(s) = \mathbf{C}(s\mathbf{I} - \mathbf{A})^{-1}\mathbf{B} = \frac{1}{s^2+3s+2}\begin{bmatrix} 1 & 0 \end{bmatrix}\begin{bmatrix} s+3 & 1 \\ -2 & s \end{bmatrix}\begin{bmatrix} 0 \\ 1 \end{bmatrix}$$

$$= \frac{1}{s^2+3s+2}$$

## 4. 実現問題

### 4.1 定義

与えられた伝達関数 $G(s)$ に対して、対応する状態空間表現 $(\mathbf{A}, \mathbf{B}, \mathbf{C}, \mathbf{D})$ を求める問題を**実現問題**と呼びます。

### 4.2 最小実現

同じ伝達関数を実現する状態空間表現は無数に存在します。その中で、**次元が最小**のものを**最小実現**と呼びます。

**最小実現の条件：**
- 可制御かつ可観測である
- 状態の次数 = 伝達関数の分母の次数

### 4.3 実現の一意性

最小実現は相似変換を除いて一意です。つまり、2つの最小実現 $(\mathbf{A}_1, \mathbf{B}_1, \mathbf{C}_1, \mathbf{D}_1)$ と $(\mathbf{A}_2, \mathbf{B}_2, \mathbf{C}_2, \mathbf{D}_2)$ に対して、ある正則行列 $\mathbf{T}$ が存在して：

$$\mathbf{A}_2 = \mathbf{T}\mathbf{A}_1\mathbf{T}^{-1}, \quad \mathbf{B}_2 = \mathbf{T}\mathbf{B}_1, \quad \mathbf{C}_2 = \mathbf{C}_1\mathbf{T}^{-1}, \quad \mathbf{D}_2 = \mathbf{D}_1$$

## 5. 多入力多出力（MIMO）システム

### 5.1 伝達関数行列

MIMO システムの伝達関数は行列で表されます：

$$\mathbf{G}(s) = \begin{bmatrix} G_{11}(s) & \cdots & G_{1m}(s) \\ \vdots & \ddots & \vdots \\ G_{p1}(s) & \cdots & G_{pm}(s) \end{bmatrix}$$

### 5.2 状態空間表現からの変換

$$\mathbf{G}(s) = \mathbf{C}(s\mathbf{I} - \mathbf{A})^{-1}\mathbf{B} + \mathbf{D}$$

この公式は、SISO の場合と同じ形です。

## 6. 直達項（フィードスルー）

### 6.1 プロパーシステム

$m < n$ の場合、$\mathbf{D} = \mathbf{0}$ となります（厳密にプロパー）。

### 6.2 分子が分母と同次の場合

$m = n$ の場合：
$$G(s) = b_n + \frac{\text{(低次項)}}{s^n + \cdots}$$

このとき、$\mathbf{D} = b_n$ となります。

## 7. 演習問題

### 問題1
以下の伝達関数を可制御正準形で実現せよ：
$$G(s) = \frac{2}{s^2 + 3s + 2}$$

### 問題2
以下の状態空間表現の伝達関数を求めよ：
$$\mathbf{A} = \begin{bmatrix} -1 & 1 \\ 0 & -2 \end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix} 1 \\ 1 \end{bmatrix}, \quad \mathbf{C} = \begin{bmatrix} 1 & 0 \end{bmatrix}, \quad \mathbf{D} = [0]$$

### 問題3
以下の伝達関数を対角正準形で実現せよ：
$$G(s) = \frac{s+3}{(s+1)(s+2)}$$

## 8. まとめ

- 伝達関数と状態空間表現は相互変換可能
- 複数の正準形が存在：可制御正準形、可観測正準形、対角正準形
- 状態空間から伝達関数への変換公式：$G(s) = \mathbf{C}(s\mathbf{I} - \mathbf{A})^{-1}\mathbf{B} + \mathbf{D}$
- 最小実現は相似変換を除いて一意
- MIMO システムでも同様の関係が成立

## 次回予告

次回は、**安定性と極**について学びます。システムの安定性を判定する方法を習得します。

## 参考文献

1. Katsuhiko Ogata, "Modern Control Engineering"
2. 児玉慎三・須田信英『システム制御理論入門』コロナ社
3. 足立修一『システム制御理論入門』コロナ社
