# 第8回：可制御性

## 学習目標
- 可制御性の概念と物理的意味を理解する
- 可制御性行列を用いた判定方法を習得する
- 可制御正準形への変換を学ぶ

## 1. はじめに

制御システムの設計において、**可制御性（controllability）**は基本的かつ重要な概念です。システムが可制御でなければ、望みの制御を実現することができません。

## 2. 可制御性の定義

### 2.1 完全可制御性

線形システム：
$$\dot{\mathbf{x}}(t) = \mathbf{A}\mathbf{x}(t) + \mathbf{B}\mathbf{u}(t)$$

において、任意の初期状態 $\mathbf{x}(t_0)$ から、有限時間 $T$ 内に、適当な入力 $\mathbf{u}(t)$ によって任意の目標状態 $\mathbf{x}(T)$ に到達できるとき、このシステムは**完全可制御**（completely controllable）であるといいます。

### 2.2 物理的意味

可制御性とは：
- すべての状態変数に制御入力の影響が及ぶこと
- システムの内部状態を自由に操作できること
- 極配置などの制御手法が適用可能であること

## 3. 可制御性の判定

### 3.1 可制御性行列

$n$ 次元システム $(\mathbf{A}, \mathbf{B})$ に対して、**可制御性行列** $\mathbf{C}_c$ を以下のように定義します：

$$\mathbf{C}_c = \begin{bmatrix} \mathbf{B} & \mathbf{A}\mathbf{B} & \mathbf{A}^2\mathbf{B} & \cdots & \mathbf{A}^{n-1}\mathbf{B} \end{bmatrix}$$

**可制御性判別定理（Kalmanのランク条件）：**

システムが完全可制御である必要十分条件は：
$$\text{rank}(\mathbf{C}_c) = n$$

### 3.2 証明の直感的理解

状態の解：
$$\mathbf{x}(T) = e^{\mathbf{A}T}\mathbf{x}(0) + \int_0^T e^{\mathbf{A}(T-\tau)}\mathbf{B}\mathbf{u}(\tau)d\tau$$

Cayley-Hamiltonの定理により、$e^{\mathbf{A}t}$ は $\mathbf{I}, \mathbf{A}, \mathbf{A}^2, \ldots, \mathbf{A}^{n-1}$ の線形結合で表せます。

したがって、到達可能な状態空間は $\text{span}\{\mathbf{B}, \mathbf{A}\mathbf{B}, \ldots, \mathbf{A}^{n-1}\mathbf{B}\}$ です。

これが全空間 $\mathbb{R}^n$ と一致するのが可制御性の条件です。

### 3.3 例題

**例1：可制御なシステム**

$$\mathbf{A} = \begin{bmatrix} 0 & 1 \\ -2 & -3 \end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix} 0 \\ 1 \end{bmatrix}$$

可制御性行列：
$$\mathbf{C}_c = \begin{bmatrix} \mathbf{B} & \mathbf{A}\mathbf{B} \end{bmatrix} = \begin{bmatrix} 0 & 1 \\ 1 & -3 \end{bmatrix}$$

$$\det(\mathbf{C}_c) = -1 \neq 0 \Rightarrow \text{rank}(\mathbf{C}_c) = 2$$

したがって、**完全可制御**です。

**例2：可制御でないシステム**

$$\mathbf{A} = \begin{bmatrix} 1 & 0 \\ 0 & 2 \end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix} 1 \\ 0 \end{bmatrix}$$

可制御性行列：
$$\mathbf{C}_c = \begin{bmatrix} 1 & 1 \\ 0 & 0 \end{bmatrix}$$

$$\text{rank}(\mathbf{C}_c) = 1 < 2$$

したがって、**可制御ではありません**。第2の状態変数 $x_2$ は制御できません。

## 4. 可制御部分空間

### 4.1 定義

可制御でないシステムにおいて、制御可能な状態の集合を**可制御部分空間**と呼びます：

$$\mathcal{C} = \text{span}\{\mathbf{B}, \mathbf{A}\mathbf{B}, \mathbf{A}^2\mathbf{B}, \ldots, \mathbf{A}^{n-1}\mathbf{B}\}$$

### 4.2 可制御・不可制御分解

適当な座標変換により、システムを可制御部分と不可制御部分に分解できます：

$$\begin{bmatrix} \dot{\bar{\mathbf{x}}}_c \\ \dot{\bar{\mathbf{x}}}_{\bar{c}} \end{bmatrix} = \begin{bmatrix} \bar{\mathbf{A}}_{11} & \bar{\mathbf{A}}_{12} \\ \mathbf{0} & \bar{\mathbf{A}}_{22} \end{bmatrix}\begin{bmatrix} \bar{\mathbf{x}}_c \\ \bar{\mathbf{x}}_{\bar{c}} \end{bmatrix} + \begin{bmatrix} \bar{\mathbf{B}}_1 \\ \mathbf{0} \end{bmatrix}\mathbf{u}$$

ここで、$(\bar{\mathbf{A}}_{11}, \bar{\mathbf{B}}_1)$ は可制御です。

## 5. 可制御正準形

### 5.1 定義

システムが完全可制御ならば、以下の**可制御正準形**（controllable canonical form）に変換できます：

$$\bar{\mathbf{A}} = \begin{bmatrix} 0 & 1 & 0 & \cdots & 0 \\ 0 & 0 & 1 & \cdots & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & 0 & \cdots & 1 \\ -a_0 & -a_1 & -a_2 & \cdots & -a_{n-1} \end{bmatrix}, \quad \bar{\mathbf{B}} = \begin{bmatrix} 0 \\ 0 \\ \vdots \\ 0 \\ 1 \end{bmatrix}$$

ここで、$a_i$ は特性多項式の係数です。

### 5.2 変換方法

変換行列 $\mathbf{T}$ は以下のように構成されます：

$$\mathbf{T} = \mathbf{C}_c\mathbf{W}$$

ここで、$\mathbf{W}$ は：

$$\mathbf{W} = \begin{bmatrix} a_{n-1} & a_{n-2} & \cdots & a_1 & 1 \\ a_{n-2} & a_{n-3} & \cdots & 1 & 0 \\ \vdots & \vdots & \ddots & \vdots & \vdots \\ a_1 & 1 & \cdots & 0 & 0 \\ 1 & 0 & \cdots & 0 & 0 \end{bmatrix}$$

新しい状態変数：$\bar{\mathbf{x}} = \mathbf{T}^{-1}\mathbf{x}$

## 6. 伝達関数との関係

### 6.1 可制御性と極零相殺

システムが可制御でない場合、伝達関数において極と零点の相殺が生じます。

**例：**
$$\mathbf{A} = \begin{bmatrix} -1 & 0 \\ 0 & -2 \end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix} 0 \\ 1 \end{bmatrix}, \quad \mathbf{C} = \begin{bmatrix} 1 & 1 \end{bmatrix}$$

伝達関数：
$$G(s) = \mathbf{C}(s\mathbf{I} - \mathbf{A})^{-1}\mathbf{B} = \frac{1}{s+2}$$

固有値 $\lambda_1 = -1$ が伝達関数に現れません（不可制御モード）。

## 7. 実用上の注意

### 7.1 数値的問題

可制御性行列 $\mathbf{C}_c$ のランク判定は、数値計算上の誤差に敏感です。

**対策：**
- 特異値分解（SVD）を用いる
- グラミアン行列を計算する

### 7.2 可制御性グラミアン

連続時間システムの**可制御性グラミアン**：

$$\mathbf{W}_c = \int_0^\infty e^{\mathbf{A}t}\mathbf{B}\mathbf{B}^Te^{\mathbf{A}^Tt}dt$$

システムが安定かつ可制御ならば、$\mathbf{W}_c > 0$ です。

リアプノフ方程式：
$$\mathbf{A}\mathbf{W}_c + \mathbf{W}_c\mathbf{A}^T = -\mathbf{B}\mathbf{B}^T$$

を解いて求められます。

## 8. 離散時間システムの可制御性

### 8.1 可制御性行列

離散時間システム：
$$\mathbf{x}[k+1] = \mathbf{A}_d\mathbf{x}[k] + \mathbf{B}_d\mathbf{u}[k]$$

可制御性行列：
$$\mathbf{C}_{c,d} = \begin{bmatrix} \mathbf{B}_d & \mathbf{A}_d\mathbf{B}_d & \cdots & \mathbf{A}_d^{n-1}\mathbf{B}_d \end{bmatrix}$$

可制御性判定：$\text{rank}(\mathbf{C}_{c,d}) = n$

## 9. 演習問題

### 問題1
以下のシステムの可制御性を判定せよ：
$$\mathbf{A} = \begin{bmatrix} 1 & 2 \\ 3 & 4 \end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix} 1 \\ 2 \end{bmatrix}$$

### 問題2
以下のシステムを可制御正準形に変換せよ：
$$\mathbf{A} = \begin{bmatrix} 0 & 1 \\ -2 & -3 \end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix} 0 \\ 1 \end{bmatrix}$$

### 問題3
以下のシステムの可制御部分空間を求めよ：
$$\mathbf{A} = \begin{bmatrix} 1 & 0 & 0 \\ 0 & 2 & 1 \\ 0 & 0 & 3 \end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix} 0 \\ 1 \\ 0 \end{bmatrix}$$

## 10. まとめ

- 可制御性は、システムの状態を制御入力で任意に操作できるかを表す
- 可制御性行列のランクにより判定可能
- 完全可制御なシステムは可制御正準形に変換可能
- 伝達関数では、不可制御モードは極零相殺として現れる
- 数値計算では可制御性グラミアンの使用が推奨される

## 次回予告

次回は、**可観測性**について学びます。可制御性の双対概念であり、状態推定に不可欠です。

## 参考文献

1. Chi-Tsong Chen, "Linear System Theory and Design"
2. 児玉慎三・須田信英『システム制御理論入門』コロナ社
3. Thomas Kailath, "Linear Systems"
